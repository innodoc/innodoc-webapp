import type { PageContextBuiltIn } from 'vite-plugin-ssr'
import type { PageContextBuiltInClient } from 'vite-plugin-ssr/client/router'

import { RootState } from '@/store/makeStore'

export type PageProps = Record<string, never>

/** Custom client-side page context. */
export type PageContextClient = Omit<PageContextBuiltInClient, 'Page'> &
  Pick<PageContextServer, 'documentProps' | 'Page' | 'pageProps' | 'PRELOADED_STATE'>

/** Custom server-side page context. */
export type PageContextServer = Omit<PageContextBuiltIn, 'Page'> & {
  /** Styles generated by Emotion. */
  emotionStyleTags: string

  /** Rendered page HTML. */
  pageHtml: string

  /** Preloaded store state. */
  PRELOADED_STATE?: RootState

  /** Document meta data. */
  documentProps?: {
    /** Page title. */
    title?: string
    /** Page description. */
    description?: string
  }

  Page: PageComponent

  pageProps: PageProps
}

/** The `export { Page }` of `.page.js` file. */
type PageComponent = (pageProps: PageProps) => React.ReactElement | null
